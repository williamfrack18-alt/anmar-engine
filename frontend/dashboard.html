<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Anmar Enterprises | Supra AI Builder</title>
    <!-- Use same fonts as landing -->
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;700&family=JetBrains+Mono:wght@400;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        /* --- CORE VISUALS MATCHING LANDING PAGE --- */
        * {
            box-sizing: border-box;
        }

        body {
            background-color: #000;
            margin: 0;
            padding: 0;
            overflow: hidden;
            /* App feel */
            height: 100vh;
            width: 100vw;
            font-family: 'Inter', sans-serif;
            color: #fff;
            zoom: 1;
        }

        :root {
            --ui-scale: 0.86;
            --build-left-col: minmax(420px, 42%);
            --build-right-col: minmax(620px, 1fr);
        }

        /* Video Background */
        .video-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -100;
            pointer-events: none;
            overflow: hidden;
        }

        .video-background iframe {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 100vw;
            height: 100vh;
            transform: translate(-50%, -50%) scale(1.5);
            pointer-events: none;
            opacity: 0.5;
            /* Slightly darker than landing for readability */
        }

        @media (min-aspect-ratio: 16/9) {
            .video-background iframe {
                width: 100vw;
                height: 56.25vw;
            }
        }

        @media (max-aspect-ratio: 16/9) {
            .video-background iframe {
                width: 177.78vh;
                height: 100vh;
            }
        }

        /* Overlays */
        .scanlines {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(to bottom, rgba(255, 255, 255, 0), rgba(255, 255, 255, 0) 50%, rgba(0, 0, 0, 0.2) 50%, rgba(0, 0, 0, 0.2));
            background-size: 100% 4px;
            z-index: -50;
            pointer-events: none;
        }

        .green-tint {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(10, 20, 10, 0.5);
            /* Slightly darker */
            z-index: -51;
            pointer-events: none;
        }

        /* --- DASHBOARD LAYOUT --- */
        .app-layout {
            display: flex;
            height: 100vh;
            padding: 2rem;
            gap: 2rem;
            z-index: 10;
            position: relative;
            transform: scale(var(--ui-scale));
            transform-origin: top left;
            width: calc(100% / var(--ui-scale));
            height: calc(100vh / var(--ui-scale));
        }

        /* Sidebar Glass */
        .sidebar {
            width: 80px;
            background: rgba(0, 0, 0, 0.4);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 2rem 0;
            gap: 2rem;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
        }

        .nav-icon {
            color: rgba(255, 255, 255, 0.4);
            font-size: 1.5rem;
            cursor: pointer;
            transition: all 0.3s;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 12px;
        }

        .nav-icon:hover,
        .nav-icon.active {
            color: #10b981;
            background: rgba(255, 255, 255, 0.05);
            box-shadow: 0 0 15px rgba(16, 185, 129, 0.2);
        }

        .spacer {
            flex-grow: 1;
        }

        /* Main Workspace Glass */
        .workspace {
            flex-grow: 1;
            display: flex;
            gap: 2rem;
            height: 100%;
        }

        /* LEFT PANEL: CHAT CONSOLE */
        .ai-console {
            flex: 1;
            /* Takes 50% or so */
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(25px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
        }

        .console-header {
            padding: 1.5rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .brand-text {
            font-weight: 700;
            letter-spacing: -0.5px;
        }

        .status-badge {
            font-size: 0.8rem;
            color: #10b981;
            display: flex;
            align-items: center;
            gap: 8px;
            background: rgba(16, 185, 129, 0.1);
            padding: 4px 12px;
            border-radius: 20px;
            border: 1px solid rgba(16, 185, 129, 0.2);
        }

        .pulse-dot {
            width: 8px;
            height: 8px;
            background: #10b981;
            border-radius: 50%;
            box-shadow: 0 0 10px #10b981;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% {
                opacity: 1;
            }

            50% {
                opacity: 0.5;
            }

            100% {
                opacity: 1;
            }
        }

        /* Terminal/Chat Logic Match */
        .terminal-wrapper {
            flex-grow: 1;
            padding: 1.5rem;
            overflow-y: auto;
            /* Change base font to clean sans-serif like Gemini */
            font-family: 'Inter', system-ui, -apple-system, sans-serif;
            font-size: 0.94rem;
            line-height: 1.5;
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        /* Chat Bubbles Style */
        .msg-row {
            display: flex;
            width: 100%;
            margin-bottom: 0.5rem;
        }

        .msg-row.ai {
            justify-content: flex-start;
        }

        .msg-row.user {
            justify-content: flex-end;
        }

        .ai-msg {
            max-width: 85%;
            color: #ececec;
            /* Almost white like Gemini */
            line-height: 1.6;
            font-weight: 400;
            letter-spacing: 0.01em;
        }

        /* Make user messages look like chat bubbles */
        .msg-row.user>div {
            background: #2a2a2a;
            padding: 10px 18px;
            border-radius: 18px 18px 2px 18px;
            color: #fff;
            max-width: 80%;
            font-size: 0.95rem;
        }

        .ai-msg strong {
            font-weight: 700;
            color: #fff;
            /* Keep strong text white */
        }

        .ai-cursor {
            display: inline-block;
            width: 8px;
            height: 16px;
            background: #10b981;
            animation: blink 1s infinite;
            vertical-align: middle;
            margin-left: 5px;
        }

        .user-msg {
            background: #fff;
            color: #000;
            padding: 12px 20px;
            border-radius: 12px 12px 0 12px;
            font-weight: 500;
            font-family: 'Inter', sans-serif;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            max-width: 80%;
            animation: slideIn 0.3s ease;
        }

        @keyframes blink {
            50% {
                opacity: 0;
            }
        }

        @keyframes slideIn {
            from {
                transform: translateY(10px);
                opacity: 0;
            }

            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        /* Input Area */
        .chat-input-area {
            padding: 1.5rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            background: rgba(0, 0, 0, 0.2);
        }

        .input-glass {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 0.5rem;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        textarea {
            background: transparent;
            border: none;
            color: #fff;
            padding: 10px;
            font-family: 'Inter', sans-serif;
            font-size: 1.02rem;
            outline: none;
            resize: none;
            height: 66px;
        }

        textarea::placeholder {
            color: rgba(255, 255, 255, 0.3);
        }

        .action-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 8px;
            padding: 0 10px 5px 10px;
        }

        .theme-selector {
            background: transparent;
            color: rgba(255, 255, 255, 0.5);
            border: none;
            font-size: 0.8rem;
            font-family: 'JetBrains Mono', monospace;
            cursor: pointer;
            outline: none;
        }

        .send-btn {
            background: #fff;
            color: #000;
            border: none;
            width: 36px;
            height: 36px;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: transform 0.2s;
        }

        .send-btn:hover {
            transform: scale(1.1);
        }


        /* RIGHT PANEL: PREVIEW */
        .preview-panel {
            flex: 1.2;
            /* Slightly wider */
            background: rgba(10, 10, 10, 0.9);
            /* Opaque for accurate color reading */
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
        }

        .browser-toolbar {
            height: 50px;
            background: rgba(255, 255, 255, 0.05);
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            display: flex;
            align-items: center;
            padding: 0 1.5rem;
            gap: 1rem;
        }

        .traffic-lights {
            display: flex;
            gap: 8px;
        }

        .light {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }

        .light.red {
            background: #ef4444;
        }

        .light.yellow {
            background: #f59e0b;
        }

        .light.green {
            background: #10b981;
        }

        .url-bar {
            flex-grow: 1;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 6px;
            height: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: rgba(255, 255, 255, 0.3);
            font-size: 0.75rem;
            font-family: 'Inter', sans-serif;
        }

        /* TABS NAVIGATION */
        .main-tabs {
            display: flex;
            gap: 5px;
            background: rgba(255, 255, 255, 0.05);
            padding: 4px;
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
        }

        .tab-btn {
            background: transparent;
            border: none;
            color: rgba(255, 255, 255, 0.6);
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-family: 'Inter', sans-serif;
            font-size: 0.75rem;
            font-weight: 600;
            letter-spacing: 1px;
            text-transform: uppercase;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .tab-btn:hover {
            color: #fff;
            background: rgba(255, 255, 255, 0.05);
        }

        .tab-btn.active {
            background: #fff;
            color: #000;
            box-shadow: 0 2px 10px rgba(255, 255, 255, 0.1);
        }

        /* SECTIONS VISIBILITY */
        .section-view {
            display: none;
            width: 100%;
            height: 100%;
        }

        .section-view.active {
            display: flex;
        }

        /* Action Buttons */
        .activate-btn {
            background: #10b981;
            color: #000;
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            font-size: 0.9rem;
            margin-top: 1rem;
            transition: box-shadow 0.3s;
        }

        .activate-btn:hover {
            box-shadow: 0 0 15px rgba(16, 185, 129, 0.4);
        }

        .token-badge {
            display: inline-flex;
            align-items: center;
            background: rgba(0, 255, 0, 0.1);
            border: 1px solid rgba(0, 255, 0, 0.2);
            color: #10b981;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            margin-left: auto;
            /* Push to right */
            transition: all 0.3s;
        }

        /* GLOBAL HEADER (Landing Match) */
        header.global-header {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 80px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 3rem;
            z-index: 1000;
            background: linear-gradient(to bottom, #000 40%, rgba(0, 0, 0, 0));
        }

        header.global-header .logo {
            font-family: 'Inter', sans-serif;
            font-weight: 700;
            font-size: 1.2rem;
            letter-spacing: -0.5px;
            color: #fff;
            text-decoration: none;
            display: block;
        }

        /* Adjust Layout for Fixed Header */
        aside {
            top: 80px !important;
            height: calc(100vh - 80px) !important;
        }

        .workspace {
            margin-top: 80px !important;
            height: calc(100vh - 80px) !important;
            padding-top: 0 !important;
        }

        #section-build.section-view.active {
            display: grid !important;
            grid-template-columns: var(--build-left-col) var(--build-right-col);
            gap: 22px;
            align-items: stretch;
        }

        #section-build .left-pane {
            width: auto !important;
            min-width: 0 !important;
            max-width: none !important;
            display: flex !important;
            flex-direction: column !important;
            gap: 6px !important;
            height: 100%;
            min-height: 0;
        }

        #section-build .preview-panel {
            min-width: 0 !important;
            width: auto !important;
            height: 100%;
            border-radius: 18px;
        }

        #briefStatePanel {
            margin-bottom: 6px !important;
            padding: 6px 10px !important;
            border-radius: 10px !important;
            background: rgba(0, 0, 0, 0.28) !important;
            min-height: 0 !important;
        }

        #briefStatePanel>div:first-child {
            margin-bottom: 4px !important;
        }

        #briefStatePanel>div:first-child span:first-child {
            font-size: 0.62rem !important;
            opacity: 0.62 !important;
        }

        #briefScoreText {
            font-size: 0.7rem !important;
        }

        #briefStatePanel>div:nth-of-type(2) {
            height: 3px !important;
            margin-bottom: 0 !important;
        }

        #briefMissingList,
        #briefSummaryText,
        #briefStatePanel>div:nth-of-type(3),
        #briefStatePanel>div:nth-of-type(5) {
            display: none !important;
        }

        #blueprintNowBtn {
            width: auto !important;
            margin-top: 6px !important;
            margin-left: auto !important;
            padding: 6px 10px !important;
            border-radius: 6px !important;
            font-size: 0.68rem !important;
        }

        .ai-console {
            min-height: 0;
        }

        #section-build .ai-console {
            flex: 1 !important;
            height: 100% !important;
        }

        #section-build .console-header {
            padding: 0.75rem 1rem;
        }

        #section-build .terminal-wrapper {
            padding: 1rem;
        }

        #section-build .chat-input-area {
            padding: 0.9rem 1rem;
        }

        @media (max-width: 1320px) {
            :root {
                --build-left-col: minmax(460px, 46%);
                --build-right-col: minmax(460px, 1fr);
            }
        }

        @media (max-width: 1080px) {
            #section-build {
                grid-template-columns: 1fr;
            }
        }

        /* Hide duplicated internal branding */
        .console-header .brand-text {
            display: none !important;
        }

        /* Adjust Console Header since brand is gone */
        .console-header {
            justify-content: flex-end !important;
            /* Push tokens to right */
        }
    </style>
    <style>
        /* FORCE VISIBILITY V2 */
        #userTokens {
            position: fixed !important;
            top: 20px !important;
            right: 20px !important;
            z-index: 9999 !important;
            background: rgba(0, 0, 0, 0.85) !important;
            border: 1px solid #10b981 !important;
            color: #10b981 !important;
            padding: 8px 16px !important;
            border-radius: 99px !important;
            font-family: 'JetBrains Mono', monospace !important;
            font-weight: bold !important;
            box-shadow: 0 0 20px rgba(16, 185, 129, 0.3) !important;
            display: flex !important;
            gap: 8px;
            pointer-events: auto;
        }
    </style>
</head>

<body>
    <!-- GLOBAL HEADER -->
    <!-- GLOBAL HEADER (Tabs) -->
    <header class="global-header" style="justify-content: space-between;">
        <!-- LEFT: LOGO -->
        <div style="width:250px;">
            <a href="index.html" class="logo">Anmar Enterprises</a>
        </div>

        <!-- CENTER: TABS -->
        <nav class="main-tabs">
            <button onclick="switchTab('projects')" class="tab-btn active" id="tab-projects">
                <i class="fas fa-folder-tree"></i> PROYECTOS
            </button>
            <button onclick="switchTab('build')" class="tab-btn" id="tab-build">
                <i class="fas fa-hammer"></i> CONSTRUCCIÓN
            </button>
            <button onclick="switchTab('market')" class="tab-btn" id="tab-market">
                <i class="fas fa-bullhorn"></i> MARKETING
            </button>
            <button onclick="switchTab('growth')" class="tab-btn" id="tab-growth">
                <i class="fas fa-chart-line"></i> CRECIMIENTO
            </button>
        </nav>

        <!-- RIGHT: STATUS -->
        <div
            style="width:250px; text-align:right; font-size:0.75rem; opacity:0.5; font-weight:600; letter-spacing:1px; font-family:'Inter';">
            SUPRA ENGINE ACTIVE
        </div>
    </header>

    <!-- VIDEO BACKGROUND -->
    <div class="video-background">
        <iframe
            src="https://www.youtube.com/embed/Uc1NI4COG9k?autoplay=1&mute=1&loop=1&playlist=Uc1NI4COG9k&controls=0&showinfo=0&rel=0&iv_load_policy=3&disablekb=1&modestbranding=1&start=120"
            title="Anmar Background" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
    </div>
    <div class="green-tint"></div>
    <div class="scanlines"></div>

    <div class="app-layout" style="display:flex; flex-direction:row; padding-top:80px; height:100vh; overflow:hidden;">

        <!-- SIDEBAR (Synced) -->
        <aside
            style="width:70px; min-width:70px; background:rgba(0,0,0,0.6); border-right:1px solid rgba(255,255,255,0.1); display:flex; flex-direction:column; align-items:center; padding-top:30px; z-index:900;">
            <div class="nav-icon active" onclick="switchTab('projects')" id="nav-projects" title="Proyectos"
                style="margin-bottom:30px; cursor:pointer; color:#fff; font-size:1.2rem; transition:0.3s;"><i
                    class="fas fa-folder-tree"></i></div>
            <div class="nav-icon" onclick="switchTab('build')" id="nav-build" title="Construcción"
                style="margin-bottom:30px; cursor:pointer; color:rgba(255,255,255,0.4); font-size:1.2rem; transition:0.3s;">
                <i class="fas fa-hammer"></i>
            </div>
            <div class="nav-icon" onclick="switchTab('market')" id="nav-market" title="Marketing"
                style="margin-bottom:30px; cursor:pointer; color:rgba(255,255,255,0.4); font-size:1.2rem; transition:0.3s;">
                <i class="fas fa-bullhorn"></i>
            </div>
            <div class="nav-icon" onclick="switchTab('growth')" id="nav-growth" title="Crecimiento"
                style="cursor:pointer; color:rgba(255,255,255,0.4); font-size:1.2rem; transition:0.3s;"><i
                    class="fas fa-chart-line"></i></div>
            <div class="nav-icon" onclick="switchTab('profile')" id="nav-profile" title="Perfil"
                style="margin-top:30px; cursor:pointer; color:rgba(255,255,255,0.4); font-size:1.2rem; transition:0.3s;">
                <i class="fas fa-user"></i>
            </div>
        </aside>

        <!-- MAIN CONTENT WRAPPER -->
        <div style="flex-grow:1; position:relative; width:calc(100% - 70px);">

            <!-- SECTION 1: CONSTRUCCIÓN (Build) -->
            <div id="section-build" class="section-view" style="padding:20px; height:100%; box-sizing:border-box;">

                <!-- LEFT: AI CHAT -->
                <div class="left-pane"
                    style="width: 44%; min-width: 520px; max-width: 620px; display: flex; flex-direction: column; gap: 12px; margin-bottom: 0;">
                    <!-- NEW: ACTIVE TIMELINE -->
                    <div id="status-timeline" style="margin-bottom: 8px; display:none; flex-direction:column; gap:8px;">
                        <span
                            style="font-family:'Inter'; font-size:0.75rem; font-weight:700; color:#fff; letter-spacing:1px; text-transform:uppercase;">Estado
                            de Entrega Interna</span>
                        <span style="font-size:0.7rem; color:rgba(255,255,255,0.65);">Se activa cuando envías el ticket
                            a ingeniería.</span>
                        <div
                            style="display:flex; justify-content:space-between; align-items:center; position:relative; padding:0 10px;">
                            <!-- Line -->
                            <div
                                style="position:absolute; left:10px; right:10px; top:50%; height:2px; background:rgba(255,255,255,0.1); z-index:0;">
                            </div>

                            <!-- Step 1: Network -->
                            <div class="timeline-step" id="step-0"
                                style="position:relative; z-index:1; display:flex; flex-direction:column; align-items:center; gap:4px;">
                                <div class="step-bubble"
                                    style="width:12px; height:12px; background:#333; border-radius:50%; transition:all 0.5s; border:2px solid #000;">
                                </div>
                                <span
                                    style="font-size:0.6rem; color:rgba(255,255,255,0.5); font-family:'Inter';">Red</span>
                            </div>
                            <!-- Step 2: Engineer -->
                            <div class="timeline-step" id="step-1"
                                style="position:relative; z-index:1; display:flex; flex-direction:column; align-items:center; gap:4px;">
                                <div class="step-bubble"
                                    style="width:12px; height:12px; background:#333; border-radius:50%; transition:all 0.5s; border:2px solid #000;">
                                </div>
                                <span
                                    style="font-size:0.6rem; color:rgba(255,255,255,0.5); font-family:'Inter';">Ingeniero</span>
                            </div>
                            <!-- Step 3: Dev -->
                            <div class="timeline-step" id="step-2"
                                style="position:relative; z-index:1; display:flex; flex-direction:column; align-items:center; gap:4px;">
                                <div class="step-bubble"
                                    style="width:12px; height:12px; background:#333; border-radius:50%; transition:all 0.5s; border:2px solid #000;">
                                </div>
                                <span
                                    style="font-size:0.6rem; color:rgba(255,255,255,0.5); font-family:'Inter';">Dev</span>
                            </div>
                            <!-- Step 4: Ready -->
                            <div class="timeline-step" id="step-3"
                                style="position:relative; z-index:1; display:flex; flex-direction:column; align-items:center; gap:4px;">
                                <div class="step-bubble"
                                    style="width:12px; height:12px; background:#333; border-radius:50%; transition:all 0.5s; border:2px solid #000;">
                                </div>
                                <span
                                    style="font-size:0.6rem; color:rgba(255,255,255,0.5); font-family:'Inter';">Listo</span>
                            </div>
                        </div>
                    </div>

                    <div id="briefStatePanel"
                        style="margin-bottom: 15px; border:1px solid rgba(255,255,255,0.12); border-radius:12px; padding:12px; background:rgba(0,0,0,0.35);">
                        <div
                            style="display:flex; justify-content:space-between; align-items:center; margin-bottom:8px;">
                            <span
                                style="font-size:0.72rem; letter-spacing:1px; text-transform:uppercase; opacity:0.8;">Estado
                                del Brief</span>
                            <span id="briefScoreText"
                                style="font-size:0.78rem; color:#93c5fd; font-weight:700;">0%</span>
                        </div>
                        <div
                            style="height:6px; border-radius:999px; background:rgba(255,255,255,0.12); overflow:hidden; margin-bottom:10px;">
                            <div id="briefScoreBar"
                                style="height:100%; width:0%; background:linear-gradient(90deg,#3b82f6,#10b981); transition:width 0.3s;">
                            </div>
                        </div>
                        <div style="font-size:0.75rem; opacity:0.8; margin-bottom:6px;">Faltantes críticos</div>
                        <div id="briefMissingList" style="font-size:0.75rem; line-height:1.45; color:#d1d5db;">summary,
                            audience, business_model, timeline, features</div>
                        <div style="font-size:0.75rem; opacity:0.8; margin:10px 0 6px;">Resumen vivo</div>
                        <div id="briefSummaryText"
                            style="font-size:0.8rem; line-height:1.45; color:#e5e7eb; min-height:36px;">Esperando
                            conversación...</div>
                    </div>

                    <section class="ai-console">
                        <div class="console-header" style="justify-content: flex-end;">

                            <!-- TOKENS UI -->
                            <div id="userTokens" class="token-badge" style="margin-right: 15px;">
                                <i class="fas fa-circle-notch fa-spin"></i>
                            </div>

                            <div class="status-badge">
                                <div class="pulse-dot"></div> SUPRA LINK ACTIVE
                            </div>
                        </div>

                        <!-- Chat History container (ID preserved for script.js) -->
                        <div class="terminal-wrapper" id="terminalLog">
                            <!-- Default Welcome Message -->
                            <div class="msg-row ai">
                                <div class="ai-msg">
                                    > Sistema Anmar inicializado.<br>
                                    > Conexión establecida con el Núcleo Supra.<br><br>
                                    Estoy listo, arquitecto. Describe tu visión en lenguaje natural y yo generaré el
                                    plano,
                                    el
                                    código y la estrategia de financiación.<br><br>
                                    <span style="color:#10b981;">¿Qué vamos a construir hoy?</span>
                                </div>
                            </div>

                            <!-- Hidden Result Section (Need to keep structure for script.js compatibility) -->
                            <div id="resultSection" style="display:none;">
                                <div class="msg-row ai">
                                    <div class="ai-msg">
                                        <strong>Plan Técnico Generado con Éxito.</strong><br>
                                        He analizado la arquitectura y seleccionado el Stack óptimo. ¿Deseas proceder a
                                        la
                                        fase
                                        de construcción?
                                        <button id="buildBtn" class="activate-btn"
                                            style="width:auto; display:inline-block; margin-top:10px;">
                                            <i class="fas fa-bolt"></i> Ejecutar Construcción (Build)
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Input Area -->
                        <div class="chat-input-area">
                            <div class="input-glass">
                                <!-- ID: businessIdea preserved -->
                                <textarea id="businessIdea"
                                    placeholder="Describe tu idea... (ej. 'Un SaaS para gestión de clínicas dentales con pagos Stripe')"></textarea>
                                <input id="imageUploadInput" type="file" accept="image/*" style="display:none;" />
                                <div id="attachmentStatus"
                                    style="display:none; font-size:0.72rem; color:#93c5fd; padding:0 10px 2px 10px;">
                                </div>
                                <div style="display:flex; justify-content:flex-end; margin:0 10px 8px 10px;">
                                    <button id="blueprintNowBtn" type="button"
                                        style="display:none; background:#2563eb; color:#fff; border:none; border-radius:8px; padding:8px 12px; cursor:pointer; font-weight:700; font-size:0.74rem;">
                                        <i class="fas fa-layer-group"></i> Generar Blueprint ahora
                                    </button>
                                </div>

                                <div class="action-bar">
                                    <div id="chatModeSwitch"
                                        style="display:flex; gap:6px; align-items:center; margin-right:10px;">
                                        <button id="modeStrategyBtn" type="button"
                                            style="background:#10b981; color:#001b12; border:none; padding:6px 10px; border-radius:8px; cursor:pointer; font-size:0.75rem; font-weight:700;">
                                            Estrategia
                                        </button>
                                        <button id="modeEditBtn" type="button"
                                            style="background:rgba(255,255,255,0.08); color:#cbd5e1; border:1px solid rgba(255,255,255,0.15); padding:6px 10px; border-radius:8px; cursor:pointer; font-size:0.75rem; font-weight:700;">
                                            Edición
                                        </button>
                                    </div>

                                    <select id="engineSelector" class="theme-selector" title="Selecciona motor de IA">
                                        <option value="antigravity">Motor: Antigravity</option>
                                        <option value="openai_codex">Motor: Codex</option>
                                    </select>

                                    <button id="uploadImageBtn" type="button"
                                        style="background:rgba(59,130,246,0.15); color:#bfdbfe; border:1px solid rgba(59,130,246,0.4); width:36px; height:36px; border-radius:8px; cursor:pointer; margin-right:8px;"
                                        title="Adjuntar imagen">
                                        <i class="fas fa-image"></i>
                                    </button>

                                    <button id="voiceInputBtn" type="button"
                                        style="background:rgba(16,185,129,0.15); color:#a7f3d0; border:1px solid rgba(16,185,129,0.4); width:36px; height:36px; border-radius:8px; cursor:pointer; margin-right:8px;"
                                        title="Dictado por voz">
                                        <i class="fas fa-microphone"></i>
                                    </button>

                                    <!-- ID: generateBtn preserved -->
                                    <button id="generateBtn" class="send-btn">
                                        <i class="fas fa-arrow-up"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </section>
                </div><!-- Close Left Pane -->

                <!-- RIGHT: PREVIEW (Expanded) -->
                <section class="preview-panel" style="flex-grow: 1; min-width: 520px; width: auto; max-width: none;">
                    <div class="browser-toolbar">
                        <div class="traffic-lights">
                            <div class="light red"></div>
                            <div class="light yellow"></div>
                            <div class="light green"></div>
                        </div>
                        <!-- Mobile Toggle -->
                        <button id="mobileViewBtn"
                            style="background:transparent; border:none; color:rgba(255,255,255,0.5); cursor:pointer; margin-left:10px;"
                            title="Mobile View">
                            <i class="fas fa-mobile-alt"></i>
                        </button>
                        <button id="desktopViewBtn"
                            style="background:transparent; border:none; color:rgba(255,255,255,0.5); cursor:pointer;"
                            title="Desktop View">
                            <i class="fas fa-desktop"></i>
                        </button>

                        <div class="url-bar" style="margin-left:10px;">preview.anmar.ai</div>
                    </div>
                    <!-- ID: previewContainer + livePreviewFrame preserved -->
                    <div id="previewContainer"
                        style="width:100%; height:100%; background:#1a1a1a; border-radius: 0 0 16px 16px; overflow:hidden; display:flex; justify-content:center; align-items:center; padding:0;">
                        <iframe id="livePreviewFrame" src=""
                            style="width:100%; height:100%; border:none; border-radius:0; background:#fff; transition: width 0.3s ease, height 0.3s ease; box-shadow: 0 0 20px rgba(0,0,0,0.5);"></iframe>

                        <!-- Placeholder when empty -->
                        <div id="emptyState"
                            style="height:100%; width:100%; display:flex; flex-direction:column; align-items:center; justify-content:center; color:#cbd5e1; background:rgba(0,0,0,0.35);">
                            <i class="fas fa-cube" style="font-size:3rem; opacity:0.2; margin-bottom:1rem;"></i>
                            <p style="opacity:0.75; font-family:'Inter';">Esperando input del motor...</p>
                        </div>
                    </div>
                </section>

            </div>

            <!-- SECTION 2: PROYECTOS -->
            <div id="section-projects" class="section-view active"
                style="padding:40px; color:#fff; flex-direction:column; align-items:center; justify-content:center; height:100%;">
                <div
                    style="background:rgba(59, 130, 246, 0.08); border:1px solid rgba(59, 130, 246, 0.3); padding:30px; border-radius:16px; text-align:left; width:min(1100px,92vw);">
                    <div style="display:flex; align-items:center; gap:12px; margin-bottom:12px;">
                        <i class="fas fa-folder-tree" style="font-size:1.4rem; color:#3b82f6;"></i>
                        <h2 style="color:#fff; margin:0;">Proyectos</h2>
                    </div>
                    <p style="opacity:0.7; margin-top:0;">Cada idea vive como proyecto independiente. Selecciona una
                        carpeta para abrir la previsualización y continuar iterando.</p>
                    <div style="display:flex; gap:10px; margin: 8px 0 20px 0;">
                        <button onclick="createNewProject()"
                            style="background:#3b82f6; color:#fff; border:none; padding:10px 14px; border-radius:8px; cursor:pointer; font-weight:600;">
                            <i class="fas fa-plus"></i> Nuevo Proyecto
                        </button>
                        <button onclick="deleteAllProjects()"
                            style="background:rgba(239,68,68,0.15); color:#fecaca; border:1px solid rgba(239,68,68,0.4); padding:10px 14px; border-radius:8px; cursor:pointer; font-weight:600;">
                            <i class="fas fa-trash"></i> Borrar Todos
                        </button>
                    </div>
                    <div id="projectsFolderGrid"
                        style="margin-top:20px; display:grid; grid-template-columns:repeat(auto-fill, minmax(220px, 1fr)); gap:12px;">
                    </div>
                </div>
            </div>

            <!-- SECTION 3: MARKETING (Placeholder) -->
            <div id="section-market" class="section-view"
                style="padding:40px; color:#fff; flex-direction:column; align-items:center; justify-content:center; height:100%;">
                <div
                    style="background:rgba(59, 130, 246, 0.1); border:1px solid rgba(59, 130, 246, 0.3); padding:40px; border-radius:16px; text-align:center;">
                    <i class="fas fa-bullhorn" style="font-size:3rem; color:#3b82f6; margin-bottom:20px;"></i>
                    <h2 style="color:#fff; margin-top:0;">Supra Marketing Engine</h2>
                    <p style="opacity:0.6; max-width:400px; line-height:1.6;">
                        Genera campañas, copys y assets visuales optimizados por IA.<br>
                        <span style="font-size:0.8rem; color:#3b82f6;">PRÓXIMAMENTE v2.1</span>
                    </p>
                </div>
            </div>

            <!-- SECTION 4: GROWTH (Placeholder) -->
            <div id="section-growth" class="section-view"
                style="padding:40px; color:#fff; flex-direction:column; align-items:center; justify-content:center; height:100%;">
                <div
                    style="background:rgba(245, 158, 11, 0.1); border:1px solid rgba(245, 158, 11, 0.3); padding:40px; border-radius:16px; text-align:center;">
                    <i class="fas fa-chart-line" style="font-size:3rem; color:#f59e0b; margin-bottom:20px;"></i>
                    <h2 style="color:#fff; margin-top:0;">Fondo de Inversión Anmar</h2>
                    <p style="opacity:0.6; max-width:400px; line-height:1.6;">
                        Solicita capital semilla y monitoriza el crecimiento de tu activo.<br>
                        <span style="font-size:0.8rem; color:#f59e0b;">PRÓXIMAMENTE v2.1</span>
                    </p>
                </div>
            </div>

            <!-- SECTION 5: PROFILE -->
            <div id="section-profile" class="section-view"
                style="padding:40px; color:#fff; flex-direction:column; align-items:center; justify-content:center; height:100%;">
                <div
                    style="background:rgba(255, 255, 255, 0.04); border:1px solid rgba(255, 255, 255, 0.15); padding:40px; border-radius:16px; text-align:left; width:min(720px,92vw);">
                    <div style="display:flex; align-items:center; gap:16px; margin-bottom:20px;">
                        <div
                            style="width:52px; height:52px; border-radius:50%; background:rgba(16,185,129,0.15); display:flex; align-items:center; justify-content:center;">
                            <i class="fas fa-user" style="color:#10b981;"></i>
                        </div>
                        <div>
                            <h2 id="profileName" style="margin:0;">Usuario Anmar</h2>
                            <div id="profileEmail" style="opacity:0.75; font-size:0.9rem;"></div>
                        </div>
                    </div>

                    <div style="display:grid; grid-template-columns:1fr 1fr; gap:12px; margin-bottom:24px;">
                        <div style="padding:14px; border:1px solid rgba(255,255,255,0.12); border-radius:10px;">
                            <div style="opacity:0.65; font-size:0.8rem;">Membresía</div>
                            <div id="profileMemberSince" style="margin-top:6px; font-weight:600;">Activo en Anmar</div>
                        </div>
                        <div style="padding:14px; border:1px solid rgba(255,255,255,0.12); border-radius:10px;">
                            <div style="opacity:0.65; font-size:0.8rem;">Créditos disponibles</div>
                            <div id="profileCredits" style="margin-top:6px; font-weight:600;">-</div>
                        </div>
                    </div>

                    <button id="logoutBtn"
                        style="background:rgba(239,68,68,0.18); color:#fecaca; border:1px solid rgba(239,68,68,0.4); padding:10px 16px; border-radius:8px; cursor:pointer; font-weight:600;">
                        <i class="fas fa-right-from-bracket"></i> Cerrar sesión
                    </button>
                </div>
            </div>

        </div> <!-- Close Main Content Wrapper -->
    </div> <!-- Close App Layout -->

    <!-- Hidden Modals preserved from original -->
    <div id="projectsModal"
        style="display:none; position:fixed; left:100px; top:100px; background:rgba(0,0,0,0.9); padding:2rem; border:1px solid #333; border-radius:12px; z-index:200; backdrop-filter:blur(10px); color:#fff; min-width:300px;">
        <h3 style="border-bottom:1px solid #333; padding-bottom:1rem; margin-top:0;">Proyectos Activos</h3>
        <ul id="projectList" style="list-style:none; padding:0; line-height:2;"></ul>
        <button onclick="toggleProjectList()"
            style="background:transparent; border:1px solid #555; color:#aaa; padding:5px 10px; border-radius:4px; margin-top:1rem; cursor:pointer;">Cerrar</button>
    </div>

    <!-- CANVAS LOGIC -->
    <canvas id="gravityCanvas"
        style="position:fixed; top:0; left:0; width:100%; height:100%; z-index:-40; pointer-events:none;"></canvas>

    <!-- PREMIUM MODAL -->
    <div id="premium-modal"
        style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; z-index:9999; background:rgba(0,0,0,0.9); backdrop-filter:blur(10px); align-items:center; justify-content:center;">
        <div
            style="background:#111; border:1px solid #333; padding:40px; border-radius:20px; max-width:500px; text-align:center; box-shadow:0 20px 50px rgba(0,0,0,0.8); position:relative; overflow:hidden;">
            <!-- Decor -->
            <div
                style="position:absolute; top:0; left:0; width:100%; height:5px; background:linear-gradient(90deg, #10b981, #3b82f6);">
            </div>

            <i class="fas fa-lock" style="font-size:3rem; color:#fff; margin-bottom:20px; opacity:0.8;"></i>

            <h2 style="color:#fff; margin-bottom:10px; font-family:'Inter'; letter-spacing:-1px;">Acceso a Ingeniería
                Humana</h2>
            <p style="color:#aaa; font-size:0.95rem; line-height:1.6; margin-bottom:30px;">
                La generación está lista. Para desplegar y asignar al equipo de élite (George & Julián), desbloquea el
                acceso Premium.
            </p>

            <button onclick="unlockPremium()"
                style="width:100%; padding:15px; background:#fff; color:#000; font-weight:700; border:none; border-radius:10px; cursor:pointer; font-size:1rem; display:flex; align-items:center; justify-content:center; gap:10px; transition:transform 0.2s;">
                <span>Desbloquear por $299</span> <i class="fas fa-arrow-right"></i>
            </button>
            <div style="margin-top:15px; font-size:0.8rem; color:#555;">Pago seguro vía Stripe (Simulado)</div>

            <button onclick="document.getElementById('premium-modal').style.display='none'"
                style="background:transparent; border:none; color:#555; margin-top:20px; cursor:pointer; font-size:0.8rem;">Cancelar</button>
        </div>
    </div>

    <!-- PRICING MODAL (Recharge Tokens) -->
    <div id="pricing-modal"
        style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; z-index:9999; background:rgba(0,0,0,0.9); backdrop-filter:blur(15px); align-items:center; justify-content:center; overflow-y:auto;">
        <div
            style="background:#0a0a0a; border:1px solid #222; padding:40px; border-radius:24px; max-width:1000px; width:90%; position:relative; box-shadow:0 0 100px rgba(16, 185, 129, 0.1); margin-top:50px;">

            <button onclick="document.getElementById('pricing-modal').style.display='none'"
                style="position:absolute; top:20px; right:20px; background:transparent; border:none; color:#555; font-size:1.5rem; cursor:pointer;">&times;</button>

            <div style="text-align:center; margin-bottom:40px;">
                <h2 style="color:#fff; margin:0 0 10px 0; font-size:2rem;">Potencia tu Construcción</h2>
                <p style="color:#666;">Selecciona el nivel de energía para el Núcleo Supra.</p>
            </div>

            <div style="display:grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap:20px;">

                <!-- PLAN 1: STARTER -->
                <div
                    style="background:#111; border:1px solid #333; padding:30px; border-radius:16px; text-align:center; transition:transform 0.2s; position:relative;">
                    <h3
                        style="color:#aaa; font-size:0.9rem; text-transform:uppercase; letter-spacing:1px; margin-bottom:10px;">
                        Starter</h3>
                    <div style="font-size:2.5rem; color:#fff; font-weight:bold; margin-bottom:20px;">$29<span
                            style="font-size:1rem; color:#555;">/mes</span></div>
                    <ul
                        style="list-style:none; padding:0; color:#ccc; line-height:2; margin-bottom:30px; font-size:0.9rem;">
                        <li><i class="fas fa-bolt" style="color:#fbbf24;"></i> <strong>10 Tokens</strong> de Generación
                        </li>
                        <li><i class="fas fa-check" style="color:#333;"></i> Acceso Básico al Motor</li>
                        <li><i class="fas fa-check" style="color:#333;"></i> Exportación de Código</li>
                    </ul>
                    <button onclick="purchasePlan('starter')"
                        style="width:100%; padding:12px; background:#333; color:#fff; border:none; border-radius:8px; font-weight:bold; cursor:pointer;">Recargar</button>
                </div>

                <!-- PLAN 2: PRO (Recommended) -->
                <div
                    style="background:#111; border:1px solid #10b981; padding:30px; border-radius:16px; text-align:center; transform:scale(1.05); position:relative; box-shadow:0 0 20px rgba(16, 185, 129, 0.2);">
                    <div
                        style="position:absolute; top:-12px; left:50%; transform:translateX(-50%); background:#10b981; color:#000; padding:2px 10px; border-radius:12px; font-size:0.7rem; font-weight:bold;">
                        RECOMENDADO</div>
                    <h3
                        style="color:#10b981; font-size:0.9rem; text-transform:uppercase; letter-spacing:1px; margin-bottom:10px;">
                        Pro Architect</h3>
                    <div style="font-size:2.5rem; color:#fff; font-weight:bold; margin-bottom:20px;">$79<span
                            style="font-size:1rem; color:#555;">/mes</span></div>
                    <ul
                        style="list-style:none; padding:0; color:#fff; line-height:2; margin-bottom:30px; font-size:0.9rem;">
                        <li><i class="fas fa-bolt" style="color:#fbbf24;"></i> <strong>50 Tokens</strong> (+ Bonus)</li>
                        <li><i class="fas fa-check" style="color:#10b981;"></i> Generación Prioritaria</li>
                        <li><i class="fas fa-check" style="color:#10b981;"></i> Soporte por Chat</li>
                    </ul>
                    <button onclick="purchasePlan('pro')"
                        style="width:100%; padding:12px; background:#10b981; color:#000; border:none; border-radius:8px; font-weight:bold; cursor:pointer; box-shadow:0 0 10px rgba(16,185,129,0.4);">Recargar
                        Ahora</button>
                </div>

                <!-- PLAN 3: AGENCY -->
                <div
                    style="background:#111; border:1px solid #3b82f6; padding:30px; border-radius:16px; text-align:center; position:relative;">
                    <h3
                        style="color:#3b82f6; font-size:0.9rem; text-transform:uppercase; letter-spacing:1px; margin-bottom:10px;">
                        Agency / Enterprise</h3>
                    <div style="font-size:2.5rem; color:#fff; font-weight:bold; margin-bottom:20px;">$299<span
                            style="font-size:1rem; color:#555;">/mes</span></div>
                    <ul
                        style="list-style:none; padding:0; color:#ccc; line-height:2; margin-bottom:30px; font-size:0.9rem;">
                        <li><i class="fas fa-infinity" style="color:#fbbf24;"></i> <strong>Tokens Ilimitados</strong>
                        </li>
                        <li><i class="fas fa-check" style="color:#3b82f6;"></i> <strong>Ingeniería Humana</strong>
                            (Maria)</li>
                        <li><i class="fas fa-check" style="color:#3b82f6;"></i> Despliegue en Servidor Privado</li>
                    </ul>
                    <button onclick="purchasePlan('agency')"
                        style="width:100%; padding:12px; background:transparent; border:1px solid #3b82f6; color:#3b82f6; border-radius:8px; font-weight:bold; cursor:pointer; transition:0.2s;">Contactar
                        Ventas</button>
                </div>

            </div>

            <div style="text-align:center; margin-top:30px; font-size:0.8rem; color:#444;">
                <i class="fas fa-lock"></i> Pagos encriptados de extremo a extremo. Garantía de satisfacción Anmar.
            </div>

        </div>
    </div>

    <script>
        // --- PARTICLES SCRIPT COPY ---
        const canvas = document.getElementById('gravityCanvas');
        const ctx = canvas.getContext('2d');
        let particlesArray;
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        let mouse = { x: null, y: null, radius: (canvas.height / 80) * (canvas.width / 80) }
        window.addEventListener('mousemove', function (event) { mouse.x = event.x; mouse.y = event.y; });
        window.addEventListener('resize', () => { canvas.width = innerWidth; canvas.height = innerHeight; mouse.radius = ((canvas.height / 80) * (canvas.height / 80)); init(); });
        class Particle {
            constructor(x, y, directionX, directionY, size, color) {
                this.x = x; this.y = y; this.directionX = directionX; this.directionY = directionY; this.size = size; this.color = color;
            }
            draw() { ctx.beginPath(); ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2, false); ctx.fillStyle = this.color; ctx.fill(); }
            update() {
                if (this.x > canvas.width || this.x < 0) this.directionX = -this.directionX;
                if (this.y > canvas.height || this.y < 0) this.directionY = -this.directionY;
                let dx = mouse.x - this.x; let dy = mouse.y - this.y; let distance = Math.sqrt(dx * dx + dy * dy);
                if (distance < mouse.radius + this.size) {
                    if (mouse.x < this.x && this.x < canvas.width - this.size * 10) this.x += 3;
                    if (mouse.x > this.x && this.x > this.size * 10) this.x -= 3;
                    if (mouse.y < this.y && this.y < canvas.height - this.size * 10) this.y += 3;
                    if (mouse.y > this.y && this.y > this.size * 10) this.y -= 3;
                }
                this.x += this.directionX; this.y += this.directionY; this.draw();
            }
        }
        function init() {
            particlesArray = [];
            let numberOfParticles = (canvas.height * canvas.width) / 9000;
            for (let i = 0; i < numberOfParticles; i++) {
                let size = (Math.random() * 2) + 1;
                let x = (Math.random() * ((innerWidth - size * 2) - (size * 2)) + size * 2);
                let y = (Math.random() * ((innerHeight - size * 2) - (size * 2)) + size * 2);
                let directionX = (Math.random() * 0.5) - 0.25;
                let directionY = (Math.random() * 0.5) - 0.25;
                particlesArray.push(new Particle(x, y, directionX, directionY, size, '#ffffff'));
            }
        }
        function animate() {
            requestAnimationFrame(animate);
            ctx.clearRect(0, 0, innerWidth, innerHeight);
            for (let i = 0; i < particlesArray.length; i++) { particlesArray[i].update(); }
            connect();
        }
        function connect() {
            let opacityValue = 1;
            for (let a = 0; a < particlesArray.length; a++) {
                for (let b = a; b < particlesArray.length; b++) {
                    let distance = ((particlesArray[a].x - particlesArray[b].x) * (particlesArray[a].x - particlesArray[b].x)) + ((particlesArray[a].y - particlesArray[b].y) * (particlesArray[a].y - particlesArray[b].y));
                    if (distance < (canvas.width / 7) * (canvas.height / 7)) {
                        opacityValue = 1 - (distance / 20000);
                        ctx.strokeStyle = 'rgba(255, 255, 255,' + opacityValue * 0.15 + ')';
                        ctx.lineWidth = 1; ctx.beginPath(); ctx.moveTo(particlesArray[a].x, particlesArray[a].y); ctx.lineTo(particlesArray[b].x, particlesArray[b].y); ctx.stroke();
                    }
                }
            }
        }
        init(); animate();

        // UI HELPERS
        function toggleProjectList() {
            const el = document.getElementById('projectsModal');
            el.style.display = el.style.display === 'none' ? 'block' : 'none';
        }
    </script>

    <!-- MAIN LOGIC (Preserving original file) -->
    <script src="script.js"></script>
</body>

</html>